# Chinese-Only Normalization Changes

## 개요 (Overview)

`only_Chinese_proper_langchain_graphrag.py`를 수정하여 다국어 키워드 생성에서 중국어 전용 키워드 생성으로 변경했습니다.

## 변경 사항 (Changes Made)

### 1. 파일 docstring 업데이트 (lines 2-9)
```python
# 변경 전 (Before)
"""
Agent-based GraphRAG (graph-bounded + vector hybrid)
...
"""

# 변경 후 (After)
"""
Agent-based GraphRAG (Chinese-focused, graph-bounded + vector hybrid)
- Chinese keyword normalization by LLM: any language question → Chinese keywords
- Cypher is generated by LLM with injected normalized Chinese TERMS (READ-ONLY)
Note: Current KG contains Chinese titles only, so all queries are normalized to Chinese.
"""
```

### 2. `_multilingual_normalize()` 함수 수정 (lines 201-214)

#### 함수 docstring (lines 203-206)
```python
# 변경 전
"""
Normalize the question into ko/zh/en keyword candidates that are likely to match KG node titles.
Returns a JSON list of strings. No synonym map or env flags are used.
"""

# 변경 후
"""
Normalize the question into Chinese keyword candidates that are likely to match KG node titles.
Returns a JSON list of Chinese strings only. No synonym map or env flags are used.
Since the current KG contains Chinese titles only, all questions are translated/normalized to Chinese.
"""
```

#### LLM prompt (lines 208-213)
```python
# 변경 전
prompt = (
    "Normalize the following question into up to 12 concise keywords/phrases "
    "that are most likely to match knowledge graph node titles. "
    "Return a JSON list of strings only (no commentary). "
    "Prefer common surface forms in Chinese (简体), English, and Korean.\n\n"
    f"Question: {question}"
)

# 변경 후
prompt = (
    "Translate and normalize the following question into up to 12 concise Chinese (简体) keywords/phrases "
    "that are most likely to match knowledge graph node titles in Chinese. "
    "Return a JSON list of Chinese strings only (no commentary). "
    "If the question is in Korean or English, translate key concepts to their Chinese equivalents.\n\n"
    f"Question: {question}"
)
```

### 3. Cypher 생성 프롬프트 업데이트 (line 135)
```python
# 변경 전
"You are a Neo4j Cypher expert for an Agricultural Knowledge Graph (Chinese/English/Korean titles).\n"

# 변경 후
"You are a Neo4j Cypher expert for an Agricultural Knowledge Graph (Chinese titles).\n"
```

### 4. 코드 주석 업데이트 (line 201, 320)
```python
# 변경 전
# ---------- multilingual normalization (LLM-only, no synonym map) ----------
# 1) multilingual normalization (LLM-only)

# 변경 후
# ---------- Chinese-only normalization (LLM-only, no synonym map) ----------
# 1) Chinese normalization (LLM-only)
```

## 동작 방식 변경 (Behavior Change)

### 변경 전 (Before)
- 한국어/영어/중국어 키워드를 모두 생성
- 예시: "벼 파종 시기는?" → ["벼", "水稻", "rice", "파종", "播种", "planting", "시기", "时期", "timing"]

### 변경 후 (After)
- 중국어 키워드만 생성 (다른 언어 질문은 자동 번역)
- 예시:
  - "벼 파종 시기는?" → ["水稻", "播种", "季节", "时期"]
  - "When to plant rice?" → ["水稻", "种植", "播种", "时间"]
  - "水稻的播种季节是?" → ["水稻", "播种", "季节"]

## 이유 (Rationale)

현재 Agriculture Knowledge Graph가 중국어 title만 포함하고 있기 때문에:
- 다국어 키워드 생성이 불필요
- 중국어 전용 키워드로 정확도 향상 가능
- LLM이 한국어/영어 질문을 중국어로 번역하여 매칭

## 영향 (Impact)

- **긍정적**: 더 정확한 키워드 매칭 (중국어 KG에 최적화)
- **중립적**: 함수명 `_multilingual_normalize()`는 유지 (코드 호환성)
- **향후**: KG에 다국어 데이터 추가 시 `gpt_proper_langchain_graphrag.py` 사용 가능

## 파일 위치

- **수정된 파일**: `C:\Users\leehyunwoo08\Desktop\졸논\model\models_langchain\models\only_Chinese_proper_langchain_graphrag.py`
- **원본 유지**: `gpt_proper_langchain_graphrag.py` (다국어 버전)
